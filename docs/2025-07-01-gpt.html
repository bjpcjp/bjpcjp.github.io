---
title: "gpt"
layout: default-foundation-20210515
date: 2025-07-01
tags: [gpt]
---

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/foundation-sites@6.7.5/dist/css/foundation.min.css">

<div class="grid-container">
  <div class="callout">
    <h2>gpt</h2>
  </div>

  <div class="grid-x grid-margin-x small-up-1 medium-up-2 large-up-3">
    <div class="cell">
      <div class="card" style="margin-bottom: 1rem; border-radius: 5px;">
        <!--
        created: 2024-07-26T01:59:45.000Z
        tags: gpt
        -->
        <div class="card-divider">
          <a href="https://chatgpt.com/gpts">Explore GPTs</a>
        </div>
        <div class="card-image">
          <img src="https://cdn.oaistatic.com/assets/gpts-og-fe0dncov.webp" alt="cover image" style="max-width: 100%;">
        </div>
        <div class="card-section">
          <p>Discover and create custom versions of ChatGPT that combine instructions, extra knowledge, and any combination of skills.</p>
        </div>
      </div>
    </div>
    <div class="cell">
      <div class="card" style="margin-bottom: 1rem; border-radius: 5px;">
        <!--
        created: 2024-07-08T22:49:23.000Z
        tags: gpt, images
        -->
        <div class="card-divider">
          <a href="https://www.oranlooney.com">OranLooney.com</a>
        </div>
      </div>
    </div>
    <div class="cell">
      <div class="card" style="margin-bottom: 1rem; border-radius: 5px;">
        <!--
        created: 2024-04-09T03:17:45.000Z
        tags: gpt, youtube
        -->
        <div class="card-divider">
          <a href="https://www.youtube.com/watch?v=kCc8FmEb1nY">Let's build GPT: from scratch, in code, spelled out. - YouTube</a>
        </div>
        <div class="card-image">
          <img src="https://i.ytimg.com/vi/kCc8FmEb1nY/maxresdefault.jpg" alt="cover image" style="max-width: 100%;">
        </div>
        <div class="card-section">
          <p>We build a Generatively Pretrained Transformer (GPT), following the paper "Attention is All You Need" and OpenAI's GPT-2 / GPT-3. We talk about connections to ChatGPT, which has taken the world by storm. We watch GitHub Copilot, itself a GPT, help us write a GPT (meta :D!) . I recommend people watch the earlier makemore videos to get comfortable with the autoregressive language modeling framework and basics of tensors and PyTorch nn, which we take for granted in this video.

Links:
- Google colab for the video: https://colab.research.google.com/drive/1JMLa53HDuA-i7ZBmqV7ZnA3c_fvtXnx-?usp=sharing
- GitHub repo for the video: https://github.com/karpathy/ng-video-lecture
- Playlist of the whole Zero to Hero series so far: https://www.youtube.com/watch?v=VMj-3S1tku0&list=PLAqhIrjkxbuWI23v9cThsA9GvCAUhRvKZ
- nanoGPT repo: https://github.com/karpathy/nanoGPT
- my website: https://karpathy.ai
- my twitter: https://twitter.com/karpathy
- our Discord channel: https://discord.gg/3zy8kqD9Cp

Supplementary links:
- Attention is All You Need paper: https://arxiv.org/abs/1706.03762
- OpenAI GPT-3 paper: https://arxiv.org/abs/2005.14165 
- OpenAI ChatGPT blog post: https://openai.com/blog/chatgpt/
- The GPU I'm training the model on is from Lambda GPU Cloud, I think the best and easiest way to spin up an on-demand GPU instance in the cloud that you can ssh to: https://lambdalabs.com . If you prefer to work in notebooks, I think the easiest path today is Google Colab.

Suggested exercises:
- EX1: The n-dimensional tensor mastery challenge: Combine the `Head` and `MultiHeadAttention` into one class that processes all the heads in parallel, treating the heads as another batch dimension (answer is in nanoGPT).
- EX2: Train the GPT on your own dataset of choice! What other data could be fun to blabber on about? (A fun advanced suggestion if you like: train a GPT to do addition of two numbers, i.e. a+b=c. You may find it helpful to predict the digits of c in reverse order, as the typical addition algorithm (that you're hoping it learns) would proceed right to left too. You may want to modify the data loader to simply serve random problems and skip the generation of train.bin, val.bin. You may want to mask out the loss at the input positions of a+b that just specify the problem using y=-1 in the targets (see CrossEntropyLoss ignore_index). Does your Transformer learn to add? Once you have this, swole doge project: build a calculator clone in GPT, for all of +-*/. Not an easy problem. You may need Chain of Thought traces.)
- EX3: Find a dataset that is very large, so large that you can't see a gap between train and val loss. Pretrain the transformer on this data, then initialize with that model and finetune it on tiny shakespeare with a smaller number of steps and lower learning rate. Can you obtain a lower validation loss by the use of pretraining?
- EX4: Read some transformer papers and implement one additional feature or change that people seem to use. Does it improve the performance of your GPT?

Chapters:
00:00:00 intro: ChatGPT, Transformers, nanoGPT, Shakespeare
baseline language modeling, code setup
00:07:52 reading and exploring the data
00:09:28 tokenization, train/val split
00:14:27 data loader: batches of chunks of data
00:22:11 simplest baseline: bigram language model, loss, generation
00:34:53 training the bigram model
00:38:00 port our code to a script
Building the "self-attention"
00:42:13 version 1: averaging past context with for loops, the weakest form of aggregation
00:47:11 the trick in self-attention: matrix multiply as weighted aggregation
00:51:54 version 2: using matrix multiply
00:54:42 version 3: adding softmax
00:58:26 minor code cleanup
01:00:18 positional encoding
01:02:00 THE CRUX OF THE VIDEO: version 4: self-attention
01:11:38 note 1: attention as communication
01:12:46 note 2: attention has no notion of space, operates over sets
01:13:40 note 3: there is no communication across batch dimension
01:14:14 note 4: encoder blocks vs. decoder blocks
01:15:39 note 5: attention vs. self-attention vs. cross-attention
01:16:56 note 6: "scaled" self-attention. why divide by sqrt(head_size)
Building the Transformer
01:19:11 inserting a single self-attention block to our network
01:21:59 multi-headed self-attention
01:24:25 feedforward layers of transformer block
01:26:48 residual connections
01:32:51 layernorm (and its relationship to our previous batchnorm)
01:37:49 scaling up the model! creating a few variables. adding dropout
Notes on Transformer
01:42:39 encoder vs. decoder vs. both (?) Transformers
01:46:22 super quick walkthrough of nanoGPT, batched multi-headed self-attention
01:48:53 back to ChatGPT, GPT-3, pretraining vs. finetuning, RLHF
01:54:32 conclusions

Corrections: 
00:57:00 Oops "tokens from the _future_ cannot communicate", not "past". Sorry! :)
01:20:05 Oops I should be using the head_size for the normalization, not C</p>
        </div>
      </div>
    </div>
    <div class="cell">
      <div class="card" style="margin-bottom: 1rem; border-radius: 5px;">
        <!--
        created: 2024-03-05T00:21:31.000Z
        tags: gpt, sql
        -->
        <div class="card-divider">
          <a href="https://explainextended.com/2023/12/31/happy-new-year-15">Happy New Year: GPT in 500 lines of SQL</a>
        </div>
        <div class="card-image">
          <img src="https://explainextended.com/wp-content/uploads/2023/12/kandinsky-download-1703639350496.jpg" alt="cover image" style="max-width: 100%;">
        </div>
        <div class="card-section">
          <p>A complete GPT2 implementation as a single SQL query in PostgreSQL.</p>
        </div>
      </div>
    </div>
    <div class="cell">
      <div class="card" style="margin-bottom: 1rem; border-radius: 5px;">
        <!--
        created: 2024-03-05T00:01:14.000Z
        tags: gpt
        -->
        <div class="card-divider">
          <a href="https://digiday.com/media/wtf-are-openais-custom-gpts">WTF are OpenAIâ€™s custom GPTs?</a>
        </div>
        <div class="card-image">
          <img src="https://digiday.com/wp-content/uploads/sites/3/2023/03/ai-thoughts-digiday-gif.gif" alt="cover image" style="max-width: 100%;">
        </div>
        <div class="card-section">
          <p>OpenAI's custom GPTs and GPT Store could proffer a potential new platform for publishers to drive referral traffic.</p>
        </div>
      </div>
    </div>
    <div class="cell">
      <div class="card" style="margin-bottom: 1rem; border-radius: 5px;">
        <!--
        created: 2024-02-04T02:56:54.000Z
        tags: arxiv, gpt
        -->
        <div class="card-divider">
          <a href="https://cdn.openai.com/research-covers/language-unsupervised/language_understanding_paper.pdf">language_understanding_paper.pdf <span style="font-size: 1em;">ðŸ“„</span></a>
        </div>
      </div>
    </div>
    <div class="cell">
      <div class="card" style="margin-bottom: 1rem; border-radius: 5px;">
        <!--
        created: 2024-02-04T02:56:50.000Z
        tags: gpt, llms
        -->
        <div class="card-divider">
          <a href="https://arxiv.org/abs/2303.17564">Title:BloombergGPT: A Large Language Model for Finance</a>
        </div>
        <div class="card-image">
          <img src="https://arxiv.org/static/browse/0.3.4/images/arxiv-logo-fb.png" alt="cover image" style="max-width: 100%;">
        </div>
        <div class="card-section">
          <p>The use of NLP in the realm of financial technology is broad and complex, with applications ranging from sentiment analysis and named entity recognition to question answering. Large Language...</p>
        </div>
      </div>
    </div>
    <div class="cell">
      <div class="card" style="margin-bottom: 1rem; border-radius: 5px;">
        <!--
        created: 2024-01-07T22:16:58.000Z
        tags: gpt, numpy
        -->
        <div class="card-divider">
          <a href="https://jaykmody.com/blog/gpt-from-scratch">GPT in 60 Lines of NumPy</a>
        </div>
        <div class="card-image">
          <img src="https://jaykmody.com/profile.png" alt="cover image" style="max-width: 100%;">
        </div>
        <div class="card-section">
          <p>Implementing a GPT model from scratch in NumPy.</p>
        </div>
      </div>
    </div>
    <div class="cell">
      <div class="card" style="margin-bottom: 1rem; border-radius: 5px;">
        <!--
        created: 2023-07-28T00:58:39.000Z
        tags: gpt, llms
        -->
        <div class="card-divider">
          <a href="https://dev.to/bitohq/claude-2-vs-claude-13-vs-gpt-4-ai-coding-comparison-k29">Is Anthropic's Claude 2 model ready to take down GPT-4? We put them to the</a>
        </div>
        <div class="card-image">
          <img src="https://media.dev.to/dynamic/image/width=1000,height=500,fit=cover,gravity=auto,format=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2F0an9xnkhqoa564q8gird.png" alt="cover image" style="max-width: 100%;">
        </div>
        <div class="card-section">
          <p>Anthropic released Claude 2, a new iteration of its AI model, to take on ChatGPT and Google Bard...</p>
        </div>
      </div>
    </div>
    <div class="cell">
      <div class="card" style="margin-bottom: 1rem; border-radius: 5px;">
        <!--
        created: 2023-07-24T00:35:52.000Z
        tags: gpt
        -->
        <div class="card-divider">
          <a href="https://simonwillison.net/2023/Jun/8/gpt-tokenizers">Understanding GPT tokenizers</a>
        </div>
        <div class="card-image">
          <img src="https://static.simonwillison.net/static/2023/gpt-token-encoder-decoder.jpg" alt="cover image" style="max-width: 100%;">
        </div>
        <div class="card-section">
          <p>Large language models such as GPT-3/4, LLaMA and PaLM work in terms of tokens. They take text, convert it into tokens (integers), then predict which tokens should come next. Playing â€¦</p>
        </div>
      </div>
    </div>
    <div class="cell">
      <div class="card" style="margin-bottom: 1rem; border-radius: 5px;">
        <!--
        created: 2023-05-28T10:38:18.000Z
        tags: gpt, llms, prompt-engineering
        -->
        <div class="card-divider">
          <a href="https://towardsdatascience.com/the-art-of-prompt-design-prompt-boundaries-and-token-healing-3b2448b0be38">The Art of Prompt Design: Prompt Boundaries and Token Healing</a>
        </div>
        <div class="card-image">
          <img src="https://miro.medium.com/v2/resize:fit:1200/1*PPLOArQM0wXZ5V55VbTNYA.png" alt="cover image" style="max-width: 100%;">
        </div>
        <div class="card-section">
          <p>Learn how standard greedy tokenization introduces a subtle and powerful bias that can have all kinds of unintended consequences.</p>
        </div>
      </div>
    </div>
    <div class="cell">
      <div class="card" style="margin-bottom: 1rem; border-radius: 5px;">
        <!--
        created: 2023-04-17T21:29:35.000Z
        tags: github, gpt
        -->
        <div class="card-divider">
          <a href="https://github.com/karpathy/nanoGPT">karpathy/nanoGPT: The simplest, fastest repository for training/finetuning</a>
        </div>
        <div class="card-image">
          <img src="https://opengraph.githubassets.com/50e75f71eebee8d4cc6f2d37825388eef29b5bebd9c0e5c5ca0fd148b028a91f/karpathy/nanoGPT" alt="cover image" style="max-width: 100%;">
        </div>
        <div class="card-section">
          <p>The simplest, fastest repository for training/finetuning medium-sized GPTs. - karpathy/nanoGPT</p>
        </div>
      </div>
    </div>
    <div class="cell">
      <div class="card" style="margin-bottom: 1rem; border-radius: 5px;">
        <!--
        created: 2023-02-04T22:40:55.000Z
        tags: gpt, ruby
        -->
        <div class="card-divider">
          <a href="https://reinteractive.com/articles/integrating-ruby-with-openai-a-beginners-guide">Integrating Ruby with OpenAI: A Beginnerâ€™s Guide</a>
        </div>
        <div class="card-image">
          <img src="https://res.cloudinary.com/hynqxvid6/image/upload/c_fit,f_auto,h_1024,w_1024/v1/media/kane-hooper-910149aaa9aee01cc1d953470e9a5c85c5c91f604076a06d99642de0f57a9ae7.png" alt="cover image" style="max-width: 100%;">
        </div>
        <div class="card-section">
          <p>As a Ruby developer, you can immediately incorporate AI into your applications through the use of the OpenAI API. Our beginners guide will take you through step by step.</p>
        </div>
      </div>
    </div>
    <div class="cell">
      <div class="card" style="margin-bottom: 1rem; border-radius: 5px;">
        <!--
        created: 2023-02-02T12:13:50.000Z
        tags: gpt
        -->
        <div class="card-divider">
          <a href="https://techcrunch.com/2023/02/01/empathys-new-tool-uses-ai-to-generate-obituaries-and-its-not-half-bad">Empathyâ€™s new tool uses AI to generate obituaries, and itâ€™s not half bad</a>
        </div>
        <div class="card-image">
          <img src="https://techcrunch.com/wp-content/uploads/2021/04/GettyImages-1218896782.jpg?resize=1200,839" alt="cover image" style="max-width: 100%;">
        </div>
        <div class="card-section">
          <p>Startup Empathy has launched a new tool that uses AI to generate obituaries. It might sound callous, but the results aren't terrible, surprisingly.</p>
        </div>
      </div>
    </div>
    <div class="cell">
      <div class="card" style="margin-bottom: 1rem; border-radius: 5px;">
        <!--
        created: 2023-01-18T19:49:43.000Z
        tags: gpt
        -->
        <div class="card-divider">
          <a href="https://dev.to/novu/creating-a-website-aggregator-with-chatgpt-react-and-nodejs-4dij">Creating a website aggregator with ChatGPT, React, and Node.js ðŸš€</a>
        </div>
        <div class="card-image">
          <img src="https://media.dev.to/dynamic/image/width=1000,height=500,fit=cover,gravity=auto,format=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Fvnzlm4u8n67thwmb6c22.jpeg" alt="cover image" style="max-width: 100%;">
        </div>
        <div class="card-section">
          <p>A website aggregator is a website that collects data from other websites across the internet and puts...</p>
        </div>
      </div>
    </div>
    <div class="cell">
      <div class="card" style="margin-bottom: 1rem; border-radius: 5px;">
        <!--
        created: 2023-01-18T19:49:37.000Z
        tags: gpt
        -->
        <div class="card-divider">
          <a href="https://summate.it/?v2=">summate.it</a>
        </div>
        <div class="card-image">
          <img src="https://summate.it/share.png?v2" alt="cover image" style="max-width: 100%;">
        </div>
        <div class="card-section">
          <p>Summarize web articles.</p>
        </div>
      </div>
    </div>
  </div>
</div>
